# Secrets
[ -f "$HOME/.env" ] && source "$HOME/.env"

# Hide computer name in terminal
export DEFAULT_USER="$(whoami)"
export XDG_DATA_HOME=$HOME/.local/share
export XDG_CONFIG_HOME=$HOME/.config

# If you come from bash you might have to change your $PATH.
{{- $paths := list -}}
{{- if stat "/opt/homebrew/bin" -}}
    {{- $paths = mustAppend $paths "/opt/homebrew/bin" -}}
{{- end -}}
{{- if $paths }}
{{- $homeDir := .chezmoi.homeDir -}}
{{- range $_, $relPath := list "bin" "go/bin" ".cargo/bin" ".local/bin" -}}
    {{- $path := joinPath $homeDir $relPath -}}
    {{- if stat $path -}}
        {{- $paths = mustAppend $paths $path -}}
    {{- end -}}
{{- end -}}
export PATH={{ toStrings $paths | join ":" }}:$PATH
{{- end }}

# Path to your oh-my-zsh installation.
export ZSH=$HOME/.oh-my-zsh

# Locale settings
export LANG="en_US.UTF-8" # Sets default locale for all categories
export LC_ALL="en_US.UTF-8" # Overrides all other locale settings
export LC_CTYPE="en_US.UTF-8" # Controls character classification and case conversion

# Use Neovim as default editor
{{ if stat (printf "%s/.local/bin/nvim" .chezmoi.homeDir) -}}
export EDITOR=$HOME/.local/bin/nvim
{{ else if lookPath "nvim" -}}
export EDITOR=nvim
{{ else -}}
export EDITOR=vim
{{ end -}}
if [[ "${TERM_PROGRAM:-unset}" == "vscode" ]]; then
  export VISUAL="code --wait"
else
  export VISUAL=nvim
fi
{{ if eq .chezmoi.os "darwin" }}
export SSH_AUTH_SOCK="$HOME/Library/Containers/com.bitwarden.desktop/Data/.bitwarden-ssh-agent.sock"
{{ end -}}
{{ if not .ephemeral -}}
    {{- $itemName := printf "github.com (%s)" .name }}
    {{- range (bitwarden "item" $itemName).fields }}
        {{- if eq .name "API Token" }}
export GITHUB_ACCESS_TOKEN={{ .value | trim }}
        {{- end }}
    {{- end }}
{{ end -}}
{{- if .personal -}}
export CHEZMOI_GITHUB_ACCESS_TOKEN=$GITHUB_ACCESS_TOKEN
{{- end }}
